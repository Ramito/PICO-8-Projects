pico-8 cartridge // http://www.pico-8.com
version 34
__lua__
function _init()
 init_dog(0)
 init_dog(1)
end

function _update60()
 update_dogs()
end

function _draw()
 cls(1)
 camera()
 map()
 for dog in all(dogs) do
  draw_dog(dog)
 end
 for dog in all(exit_dogs) do
  draw_dog(dog)
 end
end
-->8
--doggy

dogs={}
exit_dogs={}

function init_dog(player)
 local dog = {}
 dog.speed=40
 dog.jump=50
 dog.x=player*15*8
 dog.y=player*15*8
 dog.h=0
 dog.dh=0
 dog.dx=0
 dog.dy=0
 dog.anim=0
 dog.direction=player%2
 dog.player=player
 add(dogs,dog)
end

function update_dogs()
 for dog in all(dogs) do
  update_dog_input(dog)
  update_dog_move(dog)
  dog_bounds(dog)
 end
 for dog in all(exit_dogs) do
  update_dog_move(dog)
 end
end

function update_dog_input(dog)
 --bark
 if (btnp(‚ùé,dog.player)) sfx(1)
 --jump input
 if (dog.h==0) then
  if btnp(üÖæÔ∏è,dog.player) then
   sfx(2)
   dog.dh=dog.jump
  end
 end
 --move input
 local dir_x=0
 local dir_y=0
 if (btn(‚¨ÖÔ∏è,dog.player)) dir_x+=-1
 if (btn(‚û°Ô∏è,dog.player)) dir_x+=1
 if (btn(‚¨ÜÔ∏è,dog.player)) dir_y+=-1
 if (btn(‚¨áÔ∏è,dog.player)) dir_y+=1
 local norm=dir_x*dir_x+dir_y*dir_y
 if (norm==0) then
  dog.dx=0
  dog.dy=0
 else
  dog.anim+=1
  if (dog.anim%10==0) sfx(0)
  norm=1/(60*sqrt(norm))
  dog.dx=dir_x*dog.speed*norm
  dog.dy=dir_y*dog.speed*norm
 end
end

function update_dog_move(dog)
 if dog.dh!=0 or dog.h!=0 then
  dog.h+=(dog.dh/60)
  dog.dh-=100/60
 end
 if (dog.h<0) then
  dog.h=0
  dog.dh=0
 end
 dog.x+=dog.dx
 dog.y+=dog.dy
 if (dog.dx>0) dog.direction=0
 if (dog.dx<0) dog.direction=1
end

function dog_bounds(dog)
 local top_edge=15*8
 local jumping=dog.dh>0
 local exit = false
 if dog.x<0 then
  if jumping and dog.dx<0 then
   exit = true
  else
   dog.x=0
  end
 end
 if dog.y<0 then
  if jumping and dog.dy<0 then
   exit = true
  else
   dog.y=0
  end
 end
 if dog.x>top_edge then
  if jumping and dog.dx>0 then
   exit = true
  else
   dog.x=top_edge
  end
 end
 if dog.y>15*8 then
  if jumping and dog.dy>0 then
   exit = true
  else
   dog.y=top_edge
  end
 end
 if exit then
  add(exit_dogs,dog)
  del(dogs,dog)
 end
end

function draw_dog(dog)
 spr(63
   ,dog.x,dog.y
   ,1,1
   ,dog.dx<0)
 local sprite = 1
 if dog.dh>0 then
  sprite=3
 elseif dog.dh<0 then
  sprite=4
 elseif dog.dx!=0 or dog.dy!=0 then
  sprite=1+(dog.anim%20)/10
 end
 spr(sprite+dog.player*16
   ,dog.x,dog.y-dog.h
   ,1,1
   ,dog.direction==1)
end
__gfx__
000000000000000000000000000000000000d0d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000d0d000000d0d00000cdc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000d0d00000cdc000000cdc00d00dd8e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000cdc00000ddde00000ddde0dddd4840000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000d00ddde0dddd48d00d00d48d044444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007000ddd44d00444400000ddd440040004400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000044440804000040000444044440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000040040000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
51000000000000000000000000000000000010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4c0000000000000000010100000010100000a1a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e400000000010100000a1a000000a1a00c0011840000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88000000000a1a00000111400000111401111c8c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
ca000000c0011140c111ccc00c001c8c011ccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000001111cc0011cc00000111cc001000cc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000011cc00010000c000011c0cc110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000100c0000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbbbbbbb8bbbbbbbbbbbbbbbbbbbbbbbbbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbbbbbb8a8bbbbbbbbbbbbbbbbbbbbbbbbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbbbbbbb8bbbbbbbabbbbbbbbbbbbbbbbbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbabbbbb5bbbbbbbb1111bb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbabbbbbbbbbbbb0bb0bb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbbbbbb3bbbbabbabbbbbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbbbbb3b3bbbbbbbbbbbbbbbabb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbabbbbbbbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
b3b3b3bbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bb3b3bbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbabbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003003030
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000333300
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00009b9099909b900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00099988099999880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00999990009999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09990900999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
99009000009990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0099000000aa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00aa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
80008080800080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88003830880038300008080080080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
08808e8008888e800803830088038300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00888a00888aaa008008e8000888e800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0088aa0000000080888aa0008aaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0080080000000000088a880000008800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000008000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
70000000000000000000000020002020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2002020070002020070020202200d2d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
200d2d002200d2d00200d2d002202f20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2002f20002222f2002222f2000222700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
22227000027777000027770022777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
27777000220002220220002020000220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
20002000200000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
20002000000000000000000000000022000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
2220202020202020202022202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2020303020202120202030202030302000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2020202020202020202020202020302000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2020212032202020202021202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2020202023202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2020202020302020202020303120202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2020222020312320202020312020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2030202020323020202020212020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2020202021202020203020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2120202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2020202020203320202020202030202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2320222020202232312120202022202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2020202021202023202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2020202020202020222320202021202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2021202020202020302020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
4a0100000d0100e0300f0401003011010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
50010000155101a5301c5501e560205601a5500c51000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000400000d0500d0500e0501005012050160502305025050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
